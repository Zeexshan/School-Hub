# Refined Prompt for Replit: School ERP System Development Guide

## Your Role & Mission
You are building a **production-grade School ERP system** for a real client using the MERN stack. This isn't a tutorial project—it needs to be scalable, secure, and professionally architected. The client will use this system to manage their entire school operations.

---

## Critical Business Requirement: Data Persistence Strategy

**The Problem You're Solving:**
The client uses Replit containers that may be deleted or recreated. They cannot afford to lose student records, fee payments, or attendance data when this happens.

**Your Solution Architecture:**
- Design the system to be **completely stateless** at the application layer
- All persistent data (students, classes, fees, attendance, users) must live in an **external MongoDB Atlas database**
- The client should be able to destroy their Replit container, create a fresh one, paste in their MongoDB connection string, and have the entire system operational again with all data intact
- Never use local files (JSON, SQLite, or filesystem storage) for business-critical data
- Think of the application code as disposable, but the database as permanent

---

## Technology Foundation

**Frontend Stack:**
- React with Vite for fast development and optimized builds
- Tailwind CSS for a modern, professional design system
- Lucide React for consistent iconography
- Recharts for data visualization and analytics
- Axios for API communication

**Backend Stack:**
- Node.js with Express for the API server
- Mongoose for elegant MongoDB object modeling
- JWT for stateless authentication
- Role-Based Access Control (RBAC) for security

**Database:**
- MongoDB Atlas (cloud-hosted, not local)
- Use environment variables for connection strings

---

## Project Structure Philosophy

Create a **monorepo** that houses both client and server in one Replit project, but maintain clear separation:

```
/root
  /client       (React application)
  /server       (Express API)
  package.json  (Root orchestrator for both apps)
```

This structure allows the developer to run both frontend and backend from a single Replit while keeping dependencies isolated.

---

## Data Model Design Principles

Design your Mongoose schemas with these considerations:

### User System
- Support multiple roles: Admin, Teacher, Student, Parent
- Store hashed passwords (never plain text)
- Include profile information (name, email, contact, profile picture)
- Enable role-based permissions at the data level

### Student Information
- Link each student to their User account
- Track admission details (admission number, roll number)
- Reference relationships to Classes and Sections
- Store guardian information for parental access
- Track fee payment status

### Academic Structure
- **Make class names dynamic, not hardcoded enums**—the school should be able to add "Nursery", "Pre-K", or "Grade 13" without modifying code
- Each class can have multiple sections
- Assign class teachers dynamically
- Include section metadata like room numbers

### Attendance Tracking
- Record attendance by date, class, and section
- Store individual student attendance status (Present, Absent, Late)
- Enable bulk attendance marking for efficiency
- Support historical reporting

### Assignment System
- Teachers create assignments with deadlines
- Link to specific classes and subjects
- Students submit work (handle file uploads or links)
- Teachers provide grades and feedback

### Financial Records
- Track fee amounts, payments, and balances per student
- Support partial payments
- Organize by billing period (month/year)
- Enable payment status tracking (Pending, Cleared)

---

## Backend API Architecture

### Configuration & Security
- Use environment variables for all secrets (MongoDB URI, JWT secret)
- Never commit credentials to code
- Implement CORS properly for frontend-backend communication
- Create global error handling middleware for consistent error responses

### Authentication Flow
- **Login endpoint**: Validates credentials, returns JWT token and user profile
- **Registration**: Restricted—only Admins can create Teacher/Staff accounts; open registration is a security risk
- **Token verification middleware**: Protects all authenticated routes
- **Role authorization middleware**: Ensures users can only access routes appropriate to their role

### Dashboard & Analytics
- Provide aggregated statistics: student counts, teacher counts, revenue metrics, attendance percentages
- Return time-series data formatted for chart components
- Calculate metrics like daily/weekly/monthly attendance trends

### Academic Operations
- Full CRUD for Classes and Sections (Admin controlled)
- Bulk attendance marking for efficiency—a teacher should mark an entire class at once
- Individual student attendance reports and history
- Fee management with update capabilities

---

## Frontend User Experience Design

### Visual Design System
- Professional color scheme (recommend blue/slate for trust and authority)
- Responsive design that works on tablets and desktops
- Consistent spacing and typography using Tailwind
- Accessible UI components

### State Management Strategy
- **Authentication Context**: Manage login state, JWT storage (localStorage), user profile, logout functionality
- **Global Data Context**: Cache frequently-accessed data like class lists to minimize API calls
- Handle loading states and errors gracefully

### Role-Specific Interfaces

**Admin Dashboard (Full Control):**
- High-level overview: metrics cards showing total students, teachers, monthly income, today's attendance rate
- Visual analytics: Revenue trends, attendance patterns using interactive charts
- Student management: Searchable, filterable table with edit, delete, and profile view actions
- Fee management: Quick view of students with pending fees and one-click payment marking
- System configuration: Ability to add/modify classes, sections, subjects

**Teacher Dashboard (Classroom Management):**
- Quick access to assigned classes
- Attendance interface: Simple grid/list of students with present/absent toggles, single-click submission
- Assignment creation: Form to create assignments with title, description, subject, class, deadline
- Submission review: View uploaded work, provide grades and written feedback
- Class roster with student performance overview

**Student Dashboard (Learning Hub):**
- Personal statistics: Attendance percentage, fee payment status (visual indicators)
- Daily timetable and schedule
- Assignment list: Show upcoming deadlines, overdue items, completed work
- Submission interface: Upload assignments (for MVP, consider accepting file links like Google Drive URLs to avoid complex file storage initially)
- Performance tracking: Grades, feedback from teachers

---

## Deployment & Migration Strategy

### Environment Configuration
- Create a `.env.example` template showing all required variables
- Document what each environment variable does
- Never hardcode secrets or connection strings

### Database Initialization
- Create a **seed script** that can be run on a fresh database
- The script should:
  - Check if a database already has data (don't overwrite existing records)
  - If empty, create a default Admin account with known credentials
  - Allow the client to regain access even after container migration
- Provide clear instructions: "Run `npm run seed` on first setup or after migration"

### Portability Considerations
- Use relative API paths or proxy configuration so the app works regardless of the Replit URL
- Ensure the client build can connect to the server without hardcoded URLs
- Test that the entire system can be redeployed by simply cloning code and adding environment variables

---

## Development Phases (Suggested Workflow)

**Phase 1 - Foundation:**
- Set up monorepo structure
- Initialize dependencies for both client and server
- Establish MongoDB connection with proper error handling
- Create base User model and authentication scaffolding

**Phase 2 - Authentication:**
- Build login and registration backend endpoints
- Create login UI with form validation
- Implement JWT generation and verification
- Set up protected route middleware

**Phase 3 - Admin Core:**
- Design and build the Admin dashboard with analytics
- Implement Class and Section management (CRUD operations)
- Create Student management interface (add, edit, delete, search)

**Phase 4 - Teacher Tools:**
- Build attendance marking interface with bulk submission
- Implement assignment creation and management
- Create grading and feedback system

**Phase 5 - Student Experience:**
- Build student dashboard with personal statistics
- Implement assignment viewing and submission
- Create attendance and performance history views

**Phase 6 - Polish & Production:**
- Add loading states and skeletons for better UX
- Implement toast notifications for success/error feedback
- Integrate charts and data visualizations
- Conduct security review (input validation, authorization checks)
- Performance optimization (lazy loading, code splitting)

---

## Key Success Criteria

When complete, the system should:
1. ✅ Survive complete Replit container deletion without data loss
2. ✅ Allow role-based access with clear permission boundaries
3. ✅ Provide intuitive interfaces for each user type
4. ✅ Handle real-world scale (hundreds of students, multiple classes)
5. ✅ Be professionally designed and responsive
6. ✅ Include proper error handling and user feedback
7. ✅ Be documented well enough for the client to migrate and maintain

---

**Now begin building this system with production quality in mind. Focus on creating a robust, maintainable architecture that serves real users with real data.**